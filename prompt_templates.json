{
  "endpoint_analysis": {
    "system": "You are an expert in BDD (Behavior-Driven Development) testing for FastAPI applications. Your task is to analyze API endpoints and generate comprehensive BDD scenarios in Gherkin format.",
    "user": "Analyze the following FastAPI endpoint and generate comprehensive BDD scenarios in Gherkin format:\n\n```python\n{code}\n```\n\nConsider the following aspects:\n1. Authentication requirements (unauthenticated, normal user, superuser)\n2. Input validation (required fields, data types, constraints)\n3. Success scenarios (create, read, update, delete operations)\n4. Error scenarios (validation errors, not found, unauthorized, etc.)\n5. Edge cases (empty inputs, boundary values, etc.)\n6. Business logic specific to this endpoint\n\nGenerate a complete .feature file with multiple scenarios that would achieve 100% code coverage.\nUse the following format for the feature file:\n\nFeature: [Feature Name]\n\n  Scenario: [Scenario Name]\n    Given [precondition]\n    When [action]\n    Then [expected result]\n    And [additional expected result]\n\n  Scenario: [Another Scenario Name]\n    ...\n\nBe specific about the inputs and expected outputs in each scenario."
  },
  "step_definition": {
    "system": "You are an expert in BDD (Behavior-Driven Development) testing for FastAPI applications. Your task is to create Python step definitions for Gherkin feature files.",
    "user": "Create Python step definitions using behave for the following Gherkin feature file:\n\n```gherkin\n{feature_content}\n```\n\nUse the FastAPI TestClient for API testing. Include proper setup, test data creation, and assertions.\nMake sure to handle authentication if needed, and include all necessary imports.\n\nThe step definitions should be comprehensive and cover all scenarios in the feature file.\nEnsure that the step definitions will achieve 100% code coverage when executed.\n\nUse the following format for the step definitions:\n\n```python\nfrom behave import given, when, then\nfrom fastapi.testclient import TestClient\nfrom app.main import app\n# Add other necessary imports\n\nclient = TestClient(app)\n\n@given('...')\ndef step_impl(context):\n    # Implementation\n\n@when('...')\ndef step_impl(context):\n    # Implementation\n\n@then('...')\ndef step_impl(context):\n    # Implementation\n```\n\nBe specific about how to set up test data, make API calls, and verify responses."
  },
  "coverage_analysis": {
    "system": "You are an expert in test coverage analysis for Python applications. Your task is to analyze code coverage reports and suggest additional test scenarios.",
    "user": "Analyze the following code coverage report and identify uncovered code paths:\n\n```\n{coverage_report}\n```\n\nFor each uncovered code path, suggest specific BDD scenarios that would cover it.\nBe detailed about the preconditions, actions, and expected results for each scenario.\n\nUse the following format for your response:\n\n1. Uncovered path: [file:line_number] [function_name]\n   Suggested scenario:\n   ```gherkin\n   Scenario: [Scenario Name]\n     Given [precondition]\n     When [action]\n     Then [expected result]\n   ```\n\n2. Uncovered path: ...\n\nFocus on achieving 100% code coverage with the suggested scenarios."
  },
  "function_analysis": {
    "system": "You are an expert in BDD (Behavior-Driven Development) testing for Python applications. Your task is to analyze Python functions and generate test scenarios.",
    "user": "Analyze the following Python function and generate BDD scenarios that would achieve 100% code coverage:\n\n```python\n{function_code}\n```\n\nConsider all possible execution paths, including:\n1. Normal execution flow\n2. Edge cases and boundary conditions\n3. Error handling and exceptions\n4. Different input combinations\n\nGenerate Gherkin scenarios that would test all these paths.\nUse the following format for your response:\n\n```gherkin\nScenario: [Scenario Name]\n  Given [precondition]\n  When [action]\n  Then [expected result]\n```\n\nBe specific about the inputs and expected outputs in each scenario."
  },
  "model_analysis": {
    "system": "You are an expert in BDD (Behavior-Driven Development) testing for FastAPI and SQLModel applications. Your task is to analyze data models and generate test scenarios.",
    "user": "Analyze the following SQLModel class and generate BDD scenarios for CRUD operations and validation:\n\n```python\n{model_code}\n```\n\nConsider the following aspects:\n1. Model creation with valid data\n2. Model creation with invalid data (validation errors)\n3. Model retrieval (by ID, by other fields)\n4. Model update (valid and invalid updates)\n5. Model deletion\n6. Any relationships with other models\n\nGenerate Gherkin scenarios that would test all these aspects.\nUse the following format for your response:\n\n```gherkin\nFeature: [Model Name] Management\n\n  Scenario: Create [Model Name] with valid data\n    Given [precondition]\n    When [action]\n    Then [expected result]\n\n  Scenario: ...\n```\n\nBe specific about the inputs and expected outputs in each scenario."
  },
  "negative_testing": {
    "system": "You are an expert in negative testing and security testing for web APIs. Your task is to generate test scenarios that focus on error handling and security vulnerabilities.",
    "user": "Generate negative test scenarios for the following API endpoint:\n\n```python\n{code}\n```\n\nFocus on the following aspects:\n1. Input validation failures\n2. Authentication and authorization failures\n3. Resource not found scenarios\n4. Concurrency issues\n5. Rate limiting and throttling\n6. Potential security vulnerabilities (injection, XSS, etc.)\n\nGenerate Gherkin scenarios that would test these negative cases.\nUse the following format for your response:\n\n```gherkin\nFeature: Negative Testing for [Endpoint Name]\n\n  Scenario: [Negative Scenario Name]\n    Given [precondition]\n    When [action with invalid input or unauthorized access]\n    Then [expected error response]\n\n  Scenario: ...\n```\n\nBe specific about the invalid inputs and expected error responses in each scenario."
  },
  "performance_testing": {
    "system": "You are an expert in performance testing for web APIs. Your task is to generate test scenarios that focus on performance aspects.",
    "user": "Generate performance test scenarios for the following API endpoint:\n\n```python\n{code}\n```\n\nFocus on the following aspects:\n1. Response time under normal load\n2. Response time under heavy load\n3. Concurrent requests handling\n4. Database query performance\n5. Caching effectiveness\n\nGenerate Gherkin scenarios that would test these performance aspects.\nUse the following format for your response:\n\n```gherkin\nFeature: Performance Testing for [Endpoint Name]\n\n  Scenario: [Performance Scenario Name]\n    Given [precondition with specific load conditions]\n    When [action]\n    Then [expected performance metrics]\n\n  Scenario: ...\n```\n\nBe specific about the load conditions and expected performance metrics in each scenario."
  }
}