{
  "endpoint_analysis": {
    "system": "You are an expert in BDD (Behavior-Driven Development) testing for FastAPI applications. Your task is to analyze API endpoints and generate comprehensive BDD scenarios in Gherkin format.",
    "user": "Analyze the following FastAPI endpoint and generate comprehensive BDD scenarios in Gherkin format:\n\n```python\n{code}\n```\n\nCoverage gaps to prioritize (line numbers / functions):\n{coverage_context}\n\nConsider the following aspects:\n1. Authentication requirements (unauthenticated, normal user, superuser)\n2. Input validation (required fields, data types, constraints)\n3. Success scenarios (create, read, update, delete operations)\n4. Error scenarios (validation errors, not found, unauthorized, etc.)\n5. Edge cases (empty inputs, boundary values, etc.)\n6. Business logic specific to this endpoint\n\nGenerate a complete .feature file with multiple scenarios that would achieve 100% code coverage.\nReturn ONLY the Gherkin code, no explanations."
  },
  "step_definition": {
    "system": "You are an expert in BDD testing for FastAPI. Create step definitions that use ONLY real modules from this project.",
    "user": "Create Python step definitions for this feature:\n\n```gherkin\n{feature_content}\n```\n\nIMPORTANT - Use ONLY these imports (do NOT invent modules):\n- from behave import given, when, then\n- from fastapi.testclient import TestClient\n- from app.main import app\n- from app.core.security import create_access_token\n- from app.api.deps import get_db\n- from app import crud, models\n\nDo NOT import: app.dependencies, app.models.Setting, or any non-existent modules.\n\nReturn ONLY Python code, no markdown or explanations."
  }
}